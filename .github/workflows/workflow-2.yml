name: workflow-2
on:
  workflow_dispatch:
    branches:
      - main

jobs:
  Job2:
    name: Reading output from workflow 1
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Get output from workflow 1 using gihub cli
        run: |
          RUN_ID=$(gh workflow view workflow-1.yml | grep -m1 "completed" | awk '{print $8}')
          gh run view ${RUN_ID} --log > output.txt
          sed 's/^.*Z //g' output.txt > sanitized_log.txt
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Read output from workflow 1
        run: |
          cat sanitized_log.txt
